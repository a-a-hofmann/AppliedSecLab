
FIRST EXAMPLE THAT WORKED:
Here everything was calculated step by step by using online calculators. An implementation of the KeyExtractor will also be provided. 


1.1D Ard1 Kastrati (ard1_kitara)
	SHA-1:   93 CA 15 02 D1 21 3A F6 E0 8F 04 DD AA 4E 2F DF A9 BC 21 F8
		 843728224157758089598680469781220054003575693816

	SHA-256: BA 85 60 2D EE 49 10 8D 51 EF 0F C0 9E 87 7E 48 2F FC F1 CE CA 15 FB E4 		 A9 5E 4A 2B 22 13 C0 75
		 84365844302044347742552043904075808907667189812810524848966741908800016728181
		 
	
	r:   
             00:83:dc:87:56:14:89:a0:c3:4c:9c:14:be:08:7f:
             29:1f:87:17:7d:9a:89:21:51:40:46:c7:70:be:d9:
             e4:08:4b
	     59642623575134234230939895518070231410852663230075457618473304568548831791179
	     
	
	s:   
             65:d4:49:b7:67:fb:0f:ec:e7:a3:4c:7a:f8:b6:92:
             cf:56:78:c3:9b:0e:27:d5:38:fe:42:ed:d2:6f:cb:
             f3:e4
	     46058678056746925547280678187811534943734399977883495053094225254065711608804
	     



2.1E Ard2 Kastrati (ard2_kitara)
	SHA-1: 	 63 BF 2C 04 D2 E4 F8 A4 24 35 4A FF F3 38 B1 F0 C9 6C E7 7A
		 569453363226516692894505390958446814868552869754

	SHA-256: 24 69 35 54 B3 5A 9A CD 8F 16 E7 12 B5 C3 4B 67 14 AD EA E7 54 F8 AB 02 		 8A A9 18 15 79 62 B2 9B
		 16469149566879393096565071425737896809175742803142905513107066446175426228891

	 r:   
             00:83:dc:87:56:14:89:a0:c3:4c:9c:14:be:08:7f:
             29:1f:87:17:7d:9a:89:21:51:40:46:c7:70:be:d9:
             e4:08:4b
	     59642623575134234230939895518070231410852663230075457618473304568548831791179
	     

	 s:   
             22:72:25:da:b9:b9:d5:cf:40:ef:ed:30:5a:a5:d5:
             ce:65:b5:c1:c7:32:6d:dc:18:7d:bc:86:23:4a:e7:
             1e:86
	     15580318678658219831180055222348640246582405674551940578052329587765708004998
	     


e = 31415 (PI)



CA:   These are public!!! Anyone can read them in the certificate!
g: 	65:b9:69:e9:85:22:a9:fe:d9:7d:fe:8f:80:20:6b:
        d8:39:3a:0d:f7:f3:23:42:dc:62:23:72:fe:27:76:
        57:23:cc:58:e2:f9:0f:92:09:db:7d:4a:b3:4d:7a:
        6e:75:c3:51:5d:e0:bf:68:ec:6b:d5:70:f8:ae:36:
        d1:73:b9:7a:45:93:e2:63:3b:d8:1a:47:9e:0b:a6:
        63:68:7c:b3:19:04:62:95:ed:d2:82:b5:04:00:6c:
        5b:33:9f:3e:ef:58:bd:87:0e:01:c1:fc:be:70:f1:
        72:bf:a9:d0:6d:1f:b4:79:98:c5:a7:58:78:35:9d:
        70:2c:a5:7f:99:f9:c8:cd:69:2d:a4:d5:ab:f7:ff:
        dc:af:56:16:24:75:bf:dd:c5:da:3e:49:bc:77:de:
        20:a4:61:18:d9:54:39:cd:ca:7e:60:20:17:f6:31:
        cf:1d:71:31:0f:27:8e:e3:22:93:7f:03:d6:62:80:
        c0:3b:45:a7:8c:1b:a3:9a:f4:01:f8:d1:48:d0:99:
        9d:a3:04:84:10:9a:0c:36:f2:a7:06:24:7d:d0:b1:
        04:fd:87:8b:20:b1:3f:e6:39:ca:48:c4:4d:c2:03:
        8f:d4:9e:69:8d:6b:c1:70:5e:c5:b0:41:75:fc:2f:
        9e:99:c1:1b:03:ab:b9:07:b4:0e:ff:35:af:e9:3f:
        eb:07:05:b8:a2:ee:8d:64:35:95:56:c1:08:0b:88:
        9a:3c:3c:29:67:79:e9:72:05:30:fe:b7:ed:78:ad:
        8e:dd:70:9e:c9:49:3b:45:73:37:45:f2:94:10:16:
        24:4e:0e:27:3d:f4:27:57:6f:94:97:65:5f:ce:73:
        82:c5:93:1a:4b:88:bb:66:5e:aa:11:24:69:dc:13:
        b4:54:60:f7:39:ea:7c:97:42:45:3c:8a:a9:d3:fc:
        10:1e:dc:17:ca:de:93:5b:a8:7f:3e:18:b7:53:23:
        ef:5e:d9:d4:ad:e1:32:d9:26:d8:77:e5:de:61:89:
        f1:33:22:9c:9b:9b:bf:ee:d3

2308507587778013493732760760957149642629246420105510525893210754082055369877027429705702723363581015822808884361160975872978513709708588589250221666216457682370414646437447627383065816621681769294695892376920581219222873931970763687724816965170272795028805071140330171134590110518373527119031955528791283752464534479086667397958068647861424748255507820430681236170757229168293939515296286076035367630009746620129248351618473702808963453270931094908573716321264444804841165371913981028784173308755294610864791305569353791459329048896113639477716408609349464129935571858329993976153789958988153246572434248084082426139722724593251554324802358809775884124236973735500605554156920903873403387885955435817133005182007599379391603375390636630384009115430952715001036406898528667953870795434002240107374939461442620163734932111125798672463812061680306492988748561863748546633023297950742820229438252116256080300623003395837566906067

p:      00:bc:fa:4a:cd:49:79:56:e9:c7:06:48:7b:bf:28:
        30:f0:8b:8d:31:0e:5c:ce:44:c1:68:ec:e7:73:4b:
        85:67:36:ce:b2:b5:e5:45:c6:1f:25:25:18:6f:e5:
        f9:01:6d:d0:6a:19:f1:7d:5e:bd:09:c0:ae:0f:83:
        6c:39:b1:4e:ac:ab:65:a4:97:4b:10:d3:ab:e5:db:
        9d:f1:f4:c2:4e:75:39:73:57:e0:79:f6:b7:0d:3b:
        89:54:e4:0f:bd:79:50:54:6d:04:12:cb:39:e1:e7:
        91:5a:58:76:48:7e:78:42:72:8b:1f:1e:98:97:82:
        51:5e:39:a3:d2:3f:4d:40:1a:35:31:81:ff:e8:81:
        48:db:06:22:0d:3d:4e:95:c7:4c:d1:95:2c:bf:eb:
        f3:03:ba:26:90:c5:61:97:f5:0e:89:ce:0e:57:3a:
        84:4d:4b:8a:54:34:f4:92:65:f4:05:7c:5a:75:21:
        cf:a2:a1:70:4a:a5:23:61:4e:09:f7:5b:2e:2a:e4:
        a5:66:b3:53:81:11:38:fb:b8:2a:30:17:9e:c3:43:
        95:0f:2d:4e:b9:1b:5d:99:09:7b:11:4c:12:02:53:
        11:22:6d:86:1d:89:2d:3f:88:36:43:84:ad:93:05:
        db:f9:ce:9d:fb:08:30:07:b7:e2:ce:dc:89:48:2d:
        d9:57:c8:78:aa:b3:3a:3e:fe:e9:bd:d1:fd:bd:0f:
        77:84:66:4a:84:aa:27:92:b5:09:ef:d5:a3:8d:8c:
        01:71:9a:ae:db:ad:d0:58:79:ba:53:ab:f2:cf:eb:
        8c:0f:ca:ec:cc:9a:45:5f:9e:62:38:5f:34:db:8f:
        fb:cd:1f:c2:94:fd:09:18:36:58:bd:a5:8f:a9:94:
        be:03:26:58:71:de:5f:47:de:48:17:6c:26:3f:df:
        e2:3f:46:77:90:9a:16:15:6c:0a:6c:f9:6d:f4:40:
        25:3f:ef:44:3a:8d:68:2e:51:87:e4:b5:c3:3c:5d:
        3d:c8:da:84:2c:d8:35:f4:ed:0b

4288617193320185056020199745262158824073955776685204924542523168332600723986526268999084208551097416639737627109612279800402348557772527020752609331898006143944883692408563306789651080582468458022118655610574596589664707640538116663710110448359272130282176292152977208737666988159498060201317460832297492945984240625718569983540803814378570637042356625799080861747965418728460879538668492059675643208280095179195728905037212984321608245293671342660701683845959970935608330095154347405487833757093604344129095136386644865764493320684281124234779286076675010453367198062357086259039412840722577663549223575054624717228542780045652740985203640969992779377152295063204943064462878876113647181357417531733511381729296072827802036493695847196958194915139211454190840383006167811588006273515566938269583775545435691367994460334386927473368333877041381402301087578676616617828899991697695917203484531396629802772417112081534329089291


q: 	00:86:c3:2e:97:55:a7:50:8d:89:8b:66:fa:6b:bc:
        80:9f:f2:d5:2e:6b:31:a3:30:20:51:cd:72:8c:bb:
        43:4c:f7
	60954778448093754142558000411256451996581828301041967296617386510580879412471
	
Generated Key for CA: G (with generator g) has order |G| = q! G = Z_p*. Euler/Fermat!
Private-Key: (3072 bit)

priv: (x)
    78:16:b7:25:61:93:d9:7e:21:31:9c:c6:13:a0:56:
    4a:a1:2b:fb:f6:c1:0b:66:f0:9a:33:75:36:8c:77:
    da:81
    54317676492792694499412438591389818782039949433215976369255119905282116278913

pub: (g^x) modulo p 
    1a:98:d0:66:92:5b:bf:e7:56:6a:47:b2:1d:d3:9c:
    bc:44:e2:21:32:ca:ce:dd:37:1b:76:b1:59:ad:88:
    0b:2b:2d:0a:fd:7f:c6:a8:1a:29:8f:29:86:f6:c9:
    52:f0:53:b9:ea:24:d5:5e:ce:15:c2:d2:e2:d1:7c:
    cd:00:b5:fc:4a:96:55:f8:31:71:d5:61:d9:a6:df:
    cb:d8:f3:76:43:c8:7d:bd:cb:f1:fa:46:88:22:8d:
    cb:c5:3d:4b:8c:91:38:2c:48:27:32:52:4f:f0:61:
    f8:c0:46:87:07:65:6b:d5:8e:9d:52:2d:d8:fa:54:
    00:4c:13:97:02:02:d0:1d:17:7b:2c:4e:57:a3:8e:
    76:e4:97:93:19:8b:70:69:1d:a9:11:62:4c:20:7c:
    82:26:f7:e5:e5:23:59:53:87:02:a9:8f:5b:68:a3:
    ab:cc:75:75:b1:78:f5:5d:2b:75:dd:89:96:89:d5:
    1c:d8:f6:97:c7:7e:ef:81:f9:75:ac:be:41:15:2d:
    66:39:b2:80:8b:3a:ec:ec:f5:1e:2d:e6:f0:cc:d0:
    fc:ea:c3:b6:9e:53:ba:fe:20:76:a5:a0:d0:b5:20:
    cd:e0:01:20:90:14:45:c0:11:62:32:f8:b1:0a:16:
    51:05:cd:fe:bb:bf:55:4a:a6:80:ef:6d:26:48:7c:
    9e:60:99:12:32:e1:a5:96:da:6b:57:b3:f8:7e:a8:
    0b:90:e4:88:ae:5b:d8:f0:84:87:59:f0:9d:b7:18:
    b9:f7:e7:6c:49:5a:f3:c9:0f:ed:bb:d1:3b:b4:ba:
    ba:66:8f:52:f2:f4:36:a5:ff:43:e1:dd:da:4a:f9:
    e3:42:21:44:73:d1:f8:fb:00:5f:24:f1:04:b3:16:
    6b:f7:f0:81:84:44:cb:29:28:51:d5:d6:4e:c0:ac:
    a6:58:bf:2e:2f:b5:43:96:d4:ab:8c:30:ae:b5:63:
    ea:c0:af:06:cd:31:2a:f3:03:07:4d:c1:1b:ec:bd:
    9e:91:56:56:48:d3:26:74:5e

603584701752947572985685892038193013614453066321995275636999587657169094282154664705791338963135587003978689850144495501196816429346468919615037910801537331655384770482691040781643025783817351596441962611068926457107882792534118331717830756265080951580446153234654915310120254667962716852876501107730750141551999038056749427136938517358792953912702041434120628102099011040565068902028126919092260663408408091916166489566521548370596248286728685252931896040128622862349895082137562474918839203691968316388918458776233327921246351176415366020741621256592381391214721158737339757129109924563889234540773703974108088988381289950875423185251212774094756947875855764140685310096528769589744307471696765465029938674007636393573678298521543953122368629855211428852605326797774833527911106998510408122309743310635249679563872859400239105561780257386516993135730198119350604705842247309868776454366889064478365955754703484369594905694


Must:
s*k - x*r mod q = M

with the wrong sign DOESN'T work:

r*priv + s*(31415) = M mod q
r*priv + s'*(31415) = M' mod q

r*priv + s*(31415) 	= 

3 239 648 732 535 552 170 068 881 202 162 384 681 768 879 547 537 810 627 628 290 069 189 024 284 090 418 904 052 781 620 725 862 389 329 230 770 556 415 526 739 051 176 136 383 085 675 255 576 137 108 427 
			+
1 446 933 371 152 704 666 067 822 505 270 099 370 257 416 175 305 209 997 092 955 086 356 474 330 190 577 660 
			=
3239648732535552170068881202162384681768879547537810627628290069189024284090418904052781620725862389329230770556415526739051176136383085675255576137108427 + 1446933371152704666067822505270099370257416175305209997092955086356474330190577660 
			=
3 239 648 732 535 552 170 068 881 202 162 384 681 768 879 547 537 810 627 628 290 069 189 024 285 537 352 275 205 486 286 793 684 894 599 330 140 813 831 702 044 261 173 229 338 172 031 729 906 327 686 087
			=(HEX)
3ddb 12b9 e0e7 163e f113 1741 0026 bcc5 8fc6 064f 3e42 741a 7bce e890 2f43 fbd1 1b99 4a97 dc58 3173 ce7a d9ef 9655 b400 69ef b079 dfa7 7a82 e265 a4c7 f6db 0bc7

However, we need modulo q: Hence

--> 38635482158354217703941015797324731830102597412695520462939089386720280834400
		    
In Hex: 
	Digest1: 556AE87090BF1980495252830C9528CC6FE5718E72093E1D978D4B883E85F160


r*priv + s'*(31415) 	= 

3 239 648 732 535 552 170 068 881 202 162 384 681 768 879 547 537 810 627 628 290 069 189 024 284 090 418 904 052 781 620 725 862 389 329 230 770 556 415 526 739 051 176 136 383 085 675 255 576 137 108 427 	
			+	
489 455 711 290 047 975 996 521 434 810 082 533 346 386 274 266 049 213 259 513 933 999 659 716 977 012 170
			=

3 239 648 732 535 552 170 068 881 202 162 384 681 768 879 547 537 810 627 628 290 069 189 024 284 579 874 615 342 829 596 722 383 824 139 313 303 902 801 801 005 100 389 395 897 019 674 915 293 114 120 597
			=(HEX)

3ddb 12b9 e0e7 163e f113 1741 0026 bcc5 8fc6 064f 3e42 741a 7bce e890 2f43 db84 2b5a 7ccc 3605 84d0 28d8 2c44 9e4c 2597 5faa 6b51 2cfc e706 f4e8 0eff 8997 b995

However, we need modulo q: Hence 

--> 38635482158354217703941015796835783107560511019133982287694040776560878363378

In Hex:
	556a e870 90bf 1980 4952 5282 b6ef f0bb 764c 65bf 787b a9bd 0430 68f2 26c9 22f2

----------------------------------------------------------------------------------------------
 

----------------------------------------------------------------------------------------------

WIKIPEDIA: k*s - x*r = H(M) (or digest)
OpenSSL  : s = inv(k) (m + xr) mod q (This means it is slightly different from theory written in our report)

----------------------------------------------------------------------------------------------


Try e = (M-M')/(s-s') = 
	
	(38635482158354217703941015797324731830102597412695520462939089386720280834400
					-
	38635482158354217703941015796835783107560511019133982287694040776560878363378)
					/
	(46058678056746925547280678187811534943734399977883495053094225254065711608804
					-
	15580318678658219831180055222348640246582405674551940578052329587765708004998)

					=

		488 948 722 542 086 393 561 538 175 245 048 610 159 402 471 022
					/
		30 478 359 378 088 705 716 100 622 965 462 894 697 151 994 303 331 554 475 041 			895 666 300 003 603 806

					= 
					31415 (OK)

----------------------------------------------------------------------------------------------

The final calculation:

1............

s*k - x*r mod q = M

(46058678056746925547280678187811534943734399977883495053094225254065711608804 
					* 
				      31415 
					-
54317676492792694499412438591389818782039949433215976369255119905282116278913
					*
59642623575134234230939895518070231410852663230075457618473304568548831791179)
				       mod
60954778448093754142558000411256451996581828301041967296617386510580879412471

					=

(1446933371152704666067822505270099370257416175305209997092955086356474330190577660
					-
3239648732535552170068881202162384681768879547537810627628290069189024284090418904052781620725862389329230770556415526739051176136383085675255576137108427)
				       mod
60954778448093754142558000411256451996581828301041967296617386510580879412471

					=

-3239648732535552170068881202162384681768879547537810627628290069189024282643485532900076954658039884059131400298999351433841179043427999318781245946530767
				       mod
60954778448093754142558000411256451996581828301041967296617386510580879412471

					=
	
-60954778448093754142558000409899206716632407261140708759808352775890886152276
	
					=

		1357245279949421039901258536809033734689993260195
			---> DIGEST1 (YEAHHHHH! SHA-1(of first certificate))
			---> HEX: EDBCFBB626E2AE97880DF2137FBD215639ABFCA3


2..............

s'*k - x*r mod q = M

(15580318678658219831180055222348640246582405674551940578052329587765708004998 
					* 
				      31415 
					-
54317676492792694499412438591389818782039949433215976369255119905282116278913
					*
59642623575134234230939895518070231410852663230075457618473304568548831791179)
				       mod
60954778448093754142558000411256451996581828301041967296617386510580879412471

					=

(489455711290047975996521434810082533346386274266049213259513933999659716977012170
					-
3239648732535552170068881202162384681768879547537810627628290069189024284090418904052781620725862389329230770556415526739051176136383085675255576137108427)
				       mod
60954778448093754142558000411256451996581828301041967296617386510580879412471

					=

-3239648732535552170068881202162384681768879547537810627628290069189024283600963192762733644729340954519148237210029252473001962876869151675595859160096257
				       mod
60954778448093754142558000411256451996581828301041967296617386510580879412471

					=

-60954778448093754142558000410388155439174493654702246935053401386050288623298
		
					=

		868296557407334646339720361563985124530590789173
			---> DIGEST2 (YEAHHHHH! SHA-1(of second certificate))
			---> HEX: 9817C3A52D49A2C88E805DB2EC603EC021EF2E35
				






